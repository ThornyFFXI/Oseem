AugmentData = {
    Attributes = {
        {
            Name = 'STR',
            Format = 'STR+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 512 },
        },
        {
            Name = 'DEX',
            Format = 'DEX+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 513 },
        },
        {
            Name = 'VIT',
            Format = 'VIT+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 514 },
        },
        {
            Name = 'AGI',
            Format = 'AGI+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 515 },
        },
        {
            Name = 'INT',
            Format = 'INT+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 516 },
        },
        {
            Name = 'MND',
            Format = 'MND+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 517 },
        },
        {
            Name = 'CHR',
            Format = 'CHR+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 518 },
        },
        {
            Name = 'Pet: STR',
            Format = 'Pet: STR+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 1792 },
        },
        {
            Name = 'Pet: DEX',
            Format = 'Pet: DEX+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 1793 },
        },
        {
            Name = 'Pet: VIT',
            Format = 'Pet: VIT+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 1794 },
        },
        {
            Name = 'Pet: AGI',
            Format = 'Pet: AGI+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 1795 },
        },
        {
            Name = 'Pet: INT',
            Format = 'Pet: INT+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 1796 },
        },
        {
            Name = 'Pet: MND',
            Format = 'Pet: MND+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 1797 },
        },
        {
            Name = 'Pet: CHR',
            Format = 'Pet: CHR+%d',
            Minimum = 0,
            Maximum = 15,
            Value = { 0 },
            AugmentIds = { 1798 },
        }
    },
    Stats = {
        {
            Name = 'Accuracy',
            Format = 'Accuracy+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 23, 68 },
        },
        {
            Name = 'Attack',
            Format = 'Attack+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 25, 68 },
        },
        {
            Name = 'Ranged Accuracy',
            Format = 'Ranged Accuracy+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 27, 69 },
        },
        {
            Name = 'Ranged Attack',
            Format = 'Ranged Attack+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 29, 69 },
        },
        {
            Name = 'Magic Accuracy',
            Format = 'Magic Accuracy+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 35, 70 },
        },
        {
            Name = 'Magic Attack Bonus',
            Format = 'Magic Attack Bonus+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 133, 70 },
        },
        {
            Name = 'Pet: Accuracy',
            Format = 'Pet: Accuracy+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 106 },
        },
        {
            Name = 'Pet: Attack',
            Format = 'Pet: Attack+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 107 },
        },
        {
            Name = 'Pet: Ranged Accuracy',
            Format = 'Pet: Ranged Accuracy+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 106 },
        },
        {
            Name = 'Pet: Ranged Attack',
            Format = 'Pet: Ranged Attack+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 107 },
        },
        {
            Name = 'Pet: Magic Accuracy',
            Format = 'Pet: Magic Accuracy+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 100 },
        },
        {
            Name = 'Pet: Magic Attack Bonus',
            Format = 'Pet: Magic Attack Bonus+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 101 },
        },
    },
    Melee = {
        {
            Name = 'DMG:+X',
            Format = 'DMG:+%d',
            Minimum = 0,
            Maximum = 50,
            Value = { 0 },
            AugmentIds = { 45 }
        },
        {
            Name = 'Store TP',
            Format = 'Store TP+%d',
            Minimum = 0,
            Maximum = 8,
            Value = { 0 },
            AugmentIds = { 142 },
        },
        {
            Name = 'Double Attack',
            Format = 'Double Attack+%d%%%%',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 143 },
        },
        {
            Name = 'Triple Attack',
            Format = 'Triple Attack+%d%%%%',
            Minimum = 0,
            Maximum = 4,
            Value = { 0 },
            AugmentIds = { 144 },
        },
        {
            Name = 'Counter',
            Format = 'Counter+%d',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 145 },
        },
        {
            Name = 'Dual Wield',
            Format = 'Dual Wield+%d',
            Minimum = 0,
            Maximum = 6,
            Value = { 0 },
            AugmentIds = { 146 },
        },
        {
            Name = 'Weaponskill Damage',
            Format = 'Weaponskill Damage+%d%%%%',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 327 },
        },
        {
            Name = 'Critical Hit Damage',
            Format = 'Critical Hit Damage+%d%%%%',
            Minimum = 0,
            Maximum = 6,
            Value = { 0 },
            AugmentIds = { 328 },
        },
        {
            Name = 'Critical Hit Rate',
            Format = 'Critical Hit Rate+%d%%%%',
            Minimum = 0,
            Maximum = 6,
            Value = { 0 },
            AugmentIds = { 41 },
        },
        {
            Name = 'Skillchain Damage',
            Format = 'Skillchain Damage+%d%%%%',
            Minimum = 0,
            Maximum = 6,
            Value = { 0 },
            AugmentIds = { 332 },
        },
        {
            Name = 'Weaponskill Accuracy',
            Format = 'Weaponskill Accuracy+%d',
            Minimum = 0,
            Maximum = 20,
            Value = { 0 },
            AugmentIds = { 326 },
        },
        {
            Name = 'Martial Arts+',
            Format = 'Martial Arts+%d',
            Minimum = 0,
            Maximum = 6,
            Value = { 0 },
            AugmentIds = { 151 },
        },
    },
    Mage = {
        {
            Name = 'Occult Acumen',
            Format = 'Occult Acumen+%d',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 237 },
        },
        {
            Name = 'Magic Burst Damage',
            Format = 'Magic Burst Damage+%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 334 },
        },
        {
            Name = 'Fast Cast',
            Format = 'Fast Cast+%d%%%%',
            Minimum = 0,
            Maximum = 7,
            Value = { 0 },
            AugmentIds = { 140 },
        },
        {
            Name = 'Drain/Aspir Potency',
            Format = 'Drain/Aspir Potency+%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 343 },
        },
        {
            Name = 'Enhancing Magic Duration',
            Format = 'Enhancing Magic Duration+%d%%%%',
            Minimum = 0,
            Maximum = 10,
            Value = { 0 },
            AugmentIds = { 1248 },
        },
        {
            Name = 'Spell Interruption Rate-',
            Format = 'Spell Interruption Rate-%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 53 },
        },
        {
            Name = 'Conserve MP',
            Format = 'Conserve MP+%d',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 141 },
        },
        {
            Name = 'Cure Potency',
            Format = 'Cure Potency+%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 329 },
        },
        {
            Name = 'Cure Casttime',
            Format = 'Cure Casttime-%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 323 },
        },
        {
            Name = 'Resist Silence',
            Format = 'Resist Silence+%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 180 }
        },
        {
            Name = 'Magic Damage',
            Format = 'Magic Damage+%d',
            Minimum = 0,
            Maximum = 16,
            Value = { 0 },
            AugmentIds = { 362 },
        },
        {
            Name = 'Magic Critical Hit Damage+',
            Format = 'Magic Critical Hit Damage+%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 335 }
        },
        {
            Name = 'Cure Potency Received+',
            Format = 'Cure Potency Received+%d%%%%',
            Minimum = 0,
            Maximum = 8,
            Value = { 0 },
            AugmentIds = { 356 }
        },
        {
            Name = 'Refresh+',
            Format = 'Refresh+%d',
            Minimum = 0,
            Maximum = 2,
            Value = { 0 },
            AugmentIds = { 138 }
        },
        {
            Name = 'Indicolure Duration+',
            Format = 'Indicolure Duration+%d',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 1250 }
        },
        {
            Name = 'Enfeebling Magic Skill+',
            Format = 'Enfeebling Magic Skill+%d',
            Minimum = 0,
            Maximum = 16,
            Value = { 0 },
            AugmentIds = { 291 },
        }
    },
    Pet = {
        {
            Name = 'Blood Pact Damage',
            Format = 'Blood Pact Damage+%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 369 }
        },
        {
            Name = 'Repair Potency',
            Format = 'Repair Potency+%d%%%%',
            Minimum = 0,
            Maximum = 8,
            Value = { 0 },
            AugmentIds = { 341 }
        },
        {
            Name = 'Pet: Double Attack',
            Format = 'Pet: Double Attack+%d%%%%',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 123 }
        },
        {
            Name = 'Pet: Haste',
            Format = 'Pet: Haste+%d',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 111 }
        },
        {
            Name = 'Pet: Critical Hit Rate',
            Format = 'Pet: Critical Hit Rate+%d%%%%',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 102 }
        },
        {
            Name = 'Pet: Subtle Blow',
            Format = 'Pet: Subtle Blow+%d',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 116 }
        },
        {
            Name = 'Pet: Regen',
            Format = 'Pet: Regen+%d',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 110 }
        },
        {
            Name = 'Pet: Store TP',
            Format = 'Pet: Store TP+%d',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 115 }
        },
        {
            Name = 'Pet: Physical Damage Taken-',
            Format = 'Pet: Physical Damage Taken-%d%%%%',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 118 }
        },
        {
            Name = 'Blood Boon+',
            Format = 'Blood Boon+%d',
            Minimum = 0,
            Maximum = 10,
            Value = { 0 },
            AugmentIds = { 233 }
        },
        {
            Name = 'Avatar Perpetuation Cost-',
            Format = 'Avatar Perpetuation Cost-%d',
            Minimum = 0,
            Maximum = 9,
            Value = { 0 },
            AugmentIds = { 321 }
        },
        {
            Name = 'Blood Pact Ability Delay-',
            Format = 'Blood Pact Ability Delay-%d',
            Minimum = 0,
            Maximum = 6,
            Value = { 0 },
            AugmentIds = { 320 }
        }
    },
    Utility = {
        {
            Name = 'Waltz Potency',
            Format = 'Waltz Potency+%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 330 }
        },
        {
            Name = 'Physical Damage Taken',
            Format = 'Physical Damage Taken-%d%%%%',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 54 }
        },
        {
            Name = 'Magic Damage Taken',
            Format = 'Magic Damage Taken-%d%%%%',
            Minimum = 0,
            Maximum = 5,
            Value = { 0 },
            AugmentIds = { 55 }
        },
        {
            Name = 'Damage Taken',
            Format = 'Damage Taken-%d%%%%',
            Minimum = 0,
            Maximum = 4,
            Value = { 0 },
            AugmentIds = { 71 }
        },
        {
            Name = 'Enmity+',
            Format = 'Enmity+%d',
            Minimum = 0,
            Maximum = 8,
            Value = { 0 },
            AugmentIds = { 39 }
        },
        {
            Name = 'Enmity-',
            Format = 'Enmity-%d',
            Minimum = 0,
            Maximum = 8,
            Value = { 0 },
            AugmentIds = { 40 }
        },
        {
            Name = 'Chance of Successful Block+',
            Format = 'Chance of Successful Block+%d%%%%',
            Minimum = 0,
            Maximum = 4,
            Value = { 0 },
            AugmentIds = { 363 }
        },
        {
            Name = 'Subtle Blow',
            Format = 'Subtle Blow+%d%%%%',
            Minimum = 0,
            Maximum = 11,
            Value = { 0 },
            AugmentIds = { 195 }
        },
        {
            Name = 'Snapshot',
            Format = 'Snapshot+%d',
            Minimum = 0,
            Maximum = 6,
            Value = { 0 },
            AugmentIds = { 211 }
        },
        {
            Name = 'Rapid Shot',
            Format = 'Rapid Shot+%d',
            Minimum = 0,
            Maximum = 7,
            Value = { 0 },
            AugmentIds = { 139 }
        },
        {
            Name = 'Regen+',
            Format = 'Regen+%d',
            Minimum = 0,
            Maximum = 3,
            Value = { 0 },
            AugmentIds = { 137 }
        },
        {
            Name = 'Additional Effect: Stun',
            Format = 'Additional Effect: Stun+%d',
            Minimum = 0,
            Maximum = 9,
            Value = { 0 },
            AugmentIds = { 844 }
        }
    },
    Current = T{},
    Master = T{},
    Pending = T{}
};

for _,v in ipairs(AugmentData.Attributes) do
    AugmentData.Master:append(v);
end

for _,v in ipairs(AugmentData.Stats) do
    AugmentData.Master:append(v);
end

for _,v in ipairs(AugmentData.Melee) do
    AugmentData.Master:append(v);
end

for _,v in ipairs(AugmentData.Mage) do
    AugmentData.Master:append(v);
end

for _,v in ipairs(AugmentData.Pet) do
    AugmentData.Master:append(v);
end

for _,v in ipairs(AugmentData.Utility) do
    AugmentData.Master:append(v);
end

for _,v in ipairs(AugmentData.Master) do
    v.ElementName = '##' .. v.Name;
end

function BuildAugment(packet)
    for _,augmentData in pairs(AugmentData.Master) do
        augmentData.Current = nil;
        augmentData.Pending = nil;
    end

    AugmentData.Current = T{};
    for i = 1,5 do
        local augmentId = ashita.bits.unpack_be(packet.data_raw, 0x0C + (i * 2), 0, 11);
        local augmentValue = ashita.bits.unpack_be(packet.data_raw, 0x0C + (i * 2), 11, 5);
        if augmentId > 0 then
            for _,augmentData in pairs(AugmentData.Master) do
                for _,id in pairs(augmentData.AugmentIds) do
                    if (id == augmentId) then 
                        local current = augmentData.Current;
                        if current then
                            augmentData.Current = current + augmentValue + 1;
                        else
                            augmentData.Current = augmentValue + 1;
                            AugmentData.Current:append(augmentData);
                        end
                    end
                end
            end
        end
    end
    
    AugmentData.Pending = T{};
    for i = 1,5 do
        local augmentId = ashita.bits.unpack_be(packet.data_raw, 0x18 + (i * 2), 0, 11);
        local augmentValue = ashita.bits.unpack_be(packet.data_raw, 0x18 + (i * 2), 11, 5);
        if augmentId > 0 then
            for _,augmentData in pairs(AugmentData.Master) do
                for _,id in pairs(augmentData.AugmentIds) do
                    if (id == augmentId) then 
                        local pending = augmentData.Pending;
                        if pending then
                            augmentData.Pending = pending + augmentValue + 1;
                        else
                            augmentData.Pending = augmentValue + 1;
                            AugmentData.Pending:append(augmentData);
                        end
                    end
                end
            end
        end
    end
end

function EvaluateAugment()
    for _,v in pairs(gState.ActiveAugments) do
        if (v.Pending == nil) or (v.Pending < v.Value[1]) then
            return false;
        end
    end
    return true;
end